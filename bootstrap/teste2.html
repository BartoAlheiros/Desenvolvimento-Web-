<!-- UFRPE - Universidade Federal Rural de Pernanbuco
     DC - Departamento de Computacao
     Disciplina: Desenvolvimento de Aplicações Web
     Professor: Vanilson Burégio
     Aluno: José Bartolomeu Alheiros Dias Neto    
   -->
   <!DOCTYPE html>
   <html>
   <head>
    <meta charset="utf-8">
    <!--Mobile first-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--CSS-->
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="bootstrap/css/bootstrat-theme.min.css">
    <!--JS-->
    <script src="htpps://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script>

      function Funcionario(cpf, nome, cargo, salario){
        this.cpf = cpf;
        this.nome = nome;
        this.cargo = cargo;
        this.salario = Number(salario);
      }

      var funcionarios = [];

      function adicionar() {
        var form = document.forms['funcForm'];
        var cpf = form.cpf.value;
        var nome = form.nome.value; 
        var cargo = form.cargo.value; 
        var salario = form.salario.value;

        var achouF = false;  
        if(!(funcionarios.length === 0)){
          for(var i = 0; i < funcionarios.length; i++){
            if(funcionarios[i].cpf === cpf){
              achouF = true;
            }
          }
        }

        if ( !achouF ) {
          var f = new Funcionario(cpf, nome, cargo, salario);
          funcionarios.push(f);

          form.cpf.value = "";
          form.nome.value = "";
          form.cargo.value = "";
          form.salario.value = "";
          atualizarTabela();
          console.log(funcionario);
        } else {
          alert("O funcionário cpf: " + cpf + " já existe!");
        }
      }

      function remover(element) {
        //Remove da tabela
        var iElement = element.parentNode.parentNode.rowIndex;
        document.getElementById("tabelaID").deleteRow(iElement);

        //Remove da lista
        iElement = iElement - 1;
        funcionarios.splice(iElement, 1);

        alert("O funcionário foi removido");
      }  


        // adaptação do insertionSort
        /*function ordenarPorCpf(){
          var i; 
          var j; 
          var aux;
          for (i = 1; i < funcionarios.length; i++) { //Move os valores maiores para frente.
            aux = funcionarios[i];
            for(j = i; (j > 0) && (aux.cpf.value < funcionarios[j - 1].cpf.value); j--) {
              funcionarios[j] = funcionarios[j - 1]; 
              ++cont;
            }
            funcionarios[j] = aux;
          }
          atualizarTabela();
        }*/

        function atualizarTabela() {

          var linhasTabela = "";

          funcionarios.forEach(function (func) {
            linhasTabela += "<tr><td>" + func.cpf +  "</td>" + "<td>" + func.nome +  "</td>" + "<td>" + func.cargo +  "</td>" + "<td>" + func.salario +  "</td>" 
            + "<td width='10%'><input type='button' value='Remover' onclick='remover(func)'/></td>"
            + "</tr>";
          });

          document.getElementById("tabela").innerHTML = "<table><th>Cpf</th><th>Nome</th><th>Cargo</th><th>Salario</th><th></th>" + linhasTabela + "</table>";
        }


      </script>
    </head>  

    <body>
      <h1>Exemplo de Manipulação de Array e Objetos em JavaScript</h1>
      <form name="funcForm">
        <fieldset>
          <legend>Manutenção de Funcionários</legend>
          <p>Por favor, preencha os dados abaixo:</p>

          <label for="firstname">CPF:</label>
          <input type="text" name="cpf"  placeholder="Informe o cpf" autofocus>

          <label for="firstname">Nome:</label>
          <input type="text" name="nome"  placeholder="Informe o nome" autofocus>


          <label for="lastname">Cargo:</label>
          <input type="text" name="cargo" placeholder="Informe o cargo">


          <label for="age">Salário:</label>
          <input type="number" name="salario" required>

          <input type="button" value="Adicionar" onclick="adicionar()"/>
        </fieldset>
      </form>

      <br>
      <h2>Lista de Funcionários</h2>
      <input type="button" value="Ordernar por Cpf" onclick="ordenarPorCpf()"/>
      <input type="button" value="Ordernar por Nome" />
      <input type="button" value="Ordernar por Salário (DESC)"/>
      Salario maior que: <input type="number" id="filtoSalario"><input type="button" value="Filtrar"/>

      <br><br>
      <div id="tabela"></div>
      <script>
        document.getElementById("tabela").innerHTML = "<table class='table table-striped'><th>Nome</th><th>Sobrenome</th><th>Salario</th></table>";
      </script>
    </body>

    <style>
    table {
      width:100%;
    }
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }

    th {
      background-color: cornsilk;
    }

    th, td {
      padding: 5px;
      text-align: left;
    }
  </style>

  </html>